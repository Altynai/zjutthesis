% !Mode:: "TeX:UTF-8"

\documentclass[translation]{zjutreport}

\graphicspath{{figures/}}  % 定义所有的eps 文件在 figures 子目录下

\usepackage{caption}
\captionsetup{labelsep=space}%设置一般的caption，比如table和figure的。
\captionsetup[longtable]{labelsep=space}%设置指定的宏包的caption。


\begin{document}           % 开始全文

%论文题目：{中文}
\zjuttitle{基于内存数据库的大数据应用系统的设计与实现}
%作者：{中文姓名}{学号}
\zjutauthor{陈佳鹏}{200926630503}
%指导教师：{导师中文名}
\zjutmentor{陈~~~~波}
%个人信息：{毕业年份}{专业名称}
\zjutinfo{2013}{软件工程}
%学院信息：{学院中文}
\zjutcollege{计算机科学与技术学院}
%日期：{提交日期}
\zjutdate{2013年3月}
\input{preface/cover}      % 封面

\frontmatter %应接着命令\begin{document} 使用。它把页码更换为罗马数字，而且章节不计数。

\pagenumbering{Roman}
\begingroup % 在组内的chapter不换行
\let\clearpage\relax % chapter之后不换页



%%%%%%%%%% 标题 %%%%%%%%%%
\titleformat{\chapter}[block]{\sihao\heiti\filcenter\bfseries}{\CJKnumber{\thechapter}}{1ex}{}{} % 标题居中，黑体三号
\chapter*{RAMClouds：可扩展的高性能内存存储}
\titleformat{\chapter}[block]{\xiaosi\heiti}{\CJKnumber{\thechapter}、}{1ex}{}{} % 恢复标题居左，黑体四号



%%%%%%%%%% 摘要 %%%%%%%%%%
\include{preface/translation_abstract}     % 中文摘要


%%%%%%%%%% 正文 %%%%%%%%%%
\mainmatter%应出现在书的第一章前面。它启用阿拉伯数字的页码计数器，并对页码重新计数。
\chapter{引言}
在长达四十年以来的时间里，磁盘是存储计算机系统中在线信息的主要工具。
在此期间，磁盘技术经历了巨大的改进，
它一直被更高级别的存储系统所利用，如文件系统和关系数据库。但是，磁盘的性能并没有像它的容量
那样迅速改善，为了满足大型Web应用程序的需要，开发人员发现，对那些基于磁盘的系统进行扩展
已经变得越来越难。
很多人提出了基于磁盘存储的新方法来解决这个问题，另外的人建议用​​闪存设备更换磁盘。
相比之下，我们认为，解决的办法是将磁盘中主要核心的数据转移到随机存取存储器上，磁盘变成备份
/归档的角色。

在本文中，我们认为，RAMCloud作为新存储将为许多未来的应用提供存储基础。RAMCloud
将所有信息存储在商品服务器的主存储器中，使用数百或数千个这样的服务器来创建一个大型的存储系统。
因为在任何时候，所有的数据都是在DRAM中，RAMCloud可提供基于磁盘系统、
100-1000倍的低访问延时和吞
吐量的持久、可用的存储系统。虽然个别的内存是不稳定的，但RAMCloud可以使用复制和备份的技术确保数据
的耐用性和可用性，这效果等同于基于磁盘的系统。

从根本上，我们认为RAMClouds将在三个方面改变存储行业的面貌。
第一，省去了许多可扩展性的问题，
这些问题降低了当今开发人员的工作效率，它们简化了大型Web应用程序的开发流程。
第二，极低的延时将
提供更丰富的查询模型，也提供了一种新的数据密集型应用程序的设计实现方案。
第三，RAMClouds将提供需要“云计算”
的可扩展存储基底和其他数据中心的应用程序[3]。RAMCloud可以支持一个大型应用程序或许多小应用程序
，并允许小型应用程序快速扩展到大型应用程序，无需为开发人员增加额外的复杂性。


\chapter{RAMCloud概念}
RAMClouds最有可能被用于含有大量服务器的数据中心，粗略地划分为两类：应用服务器，用来实现
应用程序的逻辑，如生成Web页面或执行业务规则；存储服务器，提供长期共享存储的应用程序服务器。
传统以来，存储系统由文件系统或关系型数据库组成。但近年来，为了提高可扩展性，
研究人员开发出了各种新的存储机
制，如Bigtable[4]和memcached[16]。每个数据中心通常支持许多应用，范围从只有一个应用程序的服务器小
应用到千上万的专用应用程序和存储服务器组成的大型应用。

RAMCloud代表了一种在系统中组织存储服务器新的方式。
区分RAMCloud和其他存储系
统，主要有两个关键的属性。首先，任何时刻所有的信息都保存在DRAM中。
RAMCloud不是像memcached[16]那样缓存数据，且数据不是存
储在一个I/O设备上。DRAM是永久保存数据的地方，磁盘仅用于备份。
其次，RAMCloud必须自动扩展以支持数以
千计的存储服务器，应用程序看到的是一个单一的存储系统，和存储服务器的实际数目不相关。

存储在RAMCloud上的信息必须像存储在磁盘上的信息一样，有耐用性。
例如，单个储存服务器的出错不应该造成数据
丢失或几秒钟的系统失效。在第四章第二节中，我们讨论实现这种级别的持久性和有效性的系统所需要的技术。

表~\ref{tab:table1}~总结了现在RAMCloud的配置，此配置假设每台服务器有64~GB的内存，也就是现在
最经济有效范围内最大的内存（随着内存大小的增加，价格会有显著的增长）。这个配置提供了1000台服
务器共64~TB的储存空间，每GB~60美元。算上附加的服务器，现在有可能构建容量大约500~TB的RAMClouds。
在5到10年内，假设DRAM的技术会一直有进步，
那么就有可能以小于每GB~5美元的价格构建容量达1至10~PB的RAMClouds。

\begin{table}[htbp]
\caption{RAMClouds参考配置}\label{tab:table1}
\vspace{0.5em}
\begin{center}
{\wuhao
\begin{tabular}{cc}
\toprule[1.5pt]
\#~服务器 & 1000\\
\midrule[1pt]
每台服务器的容量 & 64~GB \\
总容量 & 64~TB \\
服务器总开销 & 4000,000\$ \\
每GB开销 & 60\$ \\
总吞吐量 & $10^{9}$ \\
\bottomrule[1.5pt]
\end{tabular}}
\end{center}
\vspace{\baselineskip}
\end{table}

\chapter{动机}
\section{应用程序扩展性}
RAMClouds产生的两个动机：应用程序、技术。从应用程序的立场来看，几十年来，关系型数据库被拿来
做储存系统，但是关系型数据库无法适应现在大规模应用程序这个级别所需要的数据规模。实质上，每个
流行的Web应用程序也已经意识到单个关系型数据库已经无法满足吞吐量的要求。随着网站的膨胀，它必须
要经历一系列大量的修改，每一个系列都会引进专案技术来扩展其存储系统，如分割数据到多个数据库中。
这些技术在一段时间内有了成效，但是当网站到达一个新级别的规模时，扩展性的问题又出现了，那就需要
更特殊更有目的的技术了。

例如，到2009年8月，Facebook的储存系统已经包含了4000个MySQL服务器。数据分布在实例之间，实例之间
的一致性明确地由Facebook应用程序的代码管理[13]。即使这样，这些数据库服务器也不能满足Facebook吞吐量
的要求，所以Facebook同时附加了2000台memcached服务器，这些服务器把最近使用的查询结果以Key-Value的
形式存储在主内存中。不幸的是，memcached和MySQL服务器之间的一致性必须由软件管理，这增加了应用程序
的复杂性。

\section{技术趋势}
RAMClouds的第二动机来源于磁盘技术的演化（见表~\ref{tab:table2}~）。在过去的25年中，磁盘容量
增加了至少10000倍，而且有可能会在未来继续增加。不幸的是，尽管这样，磁盘上信息的访问率提高的
更加慢：大数据块之间的传输率只提高了50倍，而寻道时间和旋转等待时间只提高了1/2。

\begin{table}[htbp]
\caption{25年前和现在的硬盘技术对比}\label{tab:table2}
\vspace{0.5em}
\begin{center}
{\wuhao
\begin{tabular}{cccc}
\toprule[1.5pt]
 & 1980年代中期 & 2009年 & 改善\\
\midrule[1pt]
硬盘容量 & 30~MB & 500~GB & 16667x\\
最大传输率 & 2~MB/s & 100~MB/s & 50x \\
延时（寻道+旋转）& 20~毫秒 & 10~毫秒 & 2x \\
容量/带宽（大块） & 15~秒 & 5000~秒 & 333x \\
容量/带宽（小块） & 600~秒 & 58~天 & 8333x \\
Jim Gray准则[11] & 5~分钟 & 30~小时 & 360x \\
\bottomrule[1.5pt]
\end{tabular}}
\end{center}
\vspace{\baselineskip}
\end{table}

\section{缓存}
从历史上看，高速缓存被视为
解决磁盘延时问题的答案：如果大多数访问
集中在磁盘块一个小的子集，在DRAM中保存最频繁访问的块就能实现高性能。在理想情况下，带有缓存
的系统可以用磁盘级别的成本提供类似DRAM级别的性能。

但是，由于越来越大的数据需要被存在DRAM中，表~\ref{tab:table2}~的趋势淡化了缓存所带来的好处。
而且一些新Web应用程序（例如Facebook）靠着数据之间复杂的联系几乎脱离了本地化。到2009年8月的
时候，Facebook大约25\%的线上数据被保存在memcached服务器的主内存中，提供了96.5\%的命中率。
当算上数据库服务器上的缓存时，存储系统所用的总内存大约等于总数据的75\%。因此，RAMCloud
只会为Facebook提高大约1/3的内存使用率。

\section{延时是否重要？}
RAMClouds和其他存储系统相比，最独特的方面在于极低的延时。一方面，5到10µs延时可能并不显得那么
重要，而且很难说现如今的Web应用程序需要这种级别的延时。但是，我们相信低延时是RAMClouds特点里
面最重要的。

现如今的Web应用程序已经开始以复杂的方式使用数据并且和延时问题做斗争。例如，当Facebook收到一条
HTTP请求时[13]，应用程序服务器在内部将其均分成130条请求，然后组合出结果页面。这些请求必须按顺序被
处理，因为之后的请求需要之前的请求所产生的结果。这些内部请求所积累的延时是限制响应给用户的时
间的一个因素之一，所以大多数开发人员的功夫花费在最小化请求的数量和大小上。Amazon发表了相似的结
果，使用100到200的请求去生成每个页面的HTML代码[8]。

\chapter{问题研究}
\section{低延时RPC}
虽然已经在专门的网络实现了小于10~μs的延时，如Infiniband和Myrinet，大多数现有的数据中心使用的
网络基础设施基于以太网/IP/TCP，典型的往返过程的远程调用需要300到500~µs，但是这样做的话在某些
级别上需要新的设备。今天，最大的障碍是网络交换机的延时。一个大型的数据中心可能有一个三层式交
换结构，所以每一个数据包穿过五个交换机，因为它往上移动穿过交换层后回落到目的地。如今每个典型
的交换机造成10微秒的延时，在每个方向上造成至少100~µs的交换延时。更加新的10~GB交换机（例如Ari
sta 7100S[13]）使用通过路由的办法，并且要求至多1~µs的延时，但是这样还是会造成每个方向上总共大约5
~µs网络延时。为了达到RPC时间小于10~µs的要求，需要对交换延时做附加改进。

\section{持久性和可用性}
为了RAMClouds得到广泛的应用，它必须提供高层次的持久性和可用性（至少达到如今的基于磁盘的系统一样的水平）。
这意味着一台服务器的崩溃不会造成数据丢失或几秒钟内影响系统的可用性。RAMClouds必须还提供稳定的保护，
防止电源停电，更可能需要跨数据中心进行复制。此外，
我们假设对数据持久性的任何保证在存储服务器响应写请求的时候生效。

在DRAM中，为每个对象保存一个副本是持久性可以采取的一种途径，但是在每个服务器的本地磁盘上备份新数据
可以作为每个写操作的一部分。然而，这种做法是不可取的，因为它写入延时累加到磁盘延时上，如果服务器
崩溃，数据还是不可用。至少必须讲数据复制到多台服务器机子上。

\chapter{RAMCloud缺点}
RAMClouds最明显的缺点是每比特位的高额费用和高能源消耗。由于这些指标，纯粹基于磁盘的系统[1]是RAMCloud
的50-100倍，基于闪存的存储系统是RAMCloud的5-10倍。和基于磁盘和闪存的系统，RAMCloud系在数据中心中
需要更多的地面空间。因此，如果应用程序需要廉价地存储大量的数据且具有相对低的访问速率，RAMCloud不
是最好的解决方案。

\chapter{相关工作}
近几十年以来，在存储系统中，DRAM的作用一直在稳步徒增，许多RAMCloud的想法已经扩展到其他系统中。
例如，在20世纪80年代中期，有许多与数据库中存储有关的实验研究都完全在主存储器中进行[11]。
但是，主内存中
的数据库没有被广泛采用，也许是因为他们的能力有限。对DRAM存储系统的延时优化产生的效益已经在其他
项目中得到论证，例如Rio Vista[15]。

\chapter{总结}
在未来，技术的发展趋势和应用的需求将决定越来越多的在线数据会被保存在DRAM内。在本文中，我们认为，
对于许多应用程序而言最好的长期​​解决方案可能是一个激进的方法，就是将所有数据永久的保存在DRAM中。
RAMClouds最重要的两个方面：极低的延迟，聚集大量的商业型服务器的资源的能力。两者合一，这些方面使
得RAMClouds能扩展到满足最大的Web应用程序的要求。此外，低延时能丰富更多的查询模型，这些模型会简化
应用程序的开发，且可能会诞生新的应用程序。
最后，这种途径使得RAMClouds能为需要灵活的可扩展的存储系统的
云计算平台提供了吸引人的基础条件。

\backmatter %应该插入与书中最后一部分内容的前面，如参考文献和索引。
\endgroup % 组结束

%%%%%%%%%% 参考文献 %%%%%%%%%%
\clearpage % 显式换页，使书签定位准确
%\bibliography{references/translation_reference}
\nocite{*}                                   % 若将此命令屏蔽掉，则未引用的文献不会出现在文后的参考文献中。


%%%%%%%%%% 附录 %%%%%%%%%%
%\appendix
%\include{appendix/appendix}            % 附录

\end{document}                                  % 结束全文
